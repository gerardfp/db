# JOINS

```sql
DROP TABLE IF EXISTS usuarios, articulos, compras, favoritos, resenas, chats;

CREATE TABLE usuarios (
    id_usuario INT,
    nombre TEXT,
    email TEXT,
    telefono TEXT,
    fecha_alta DATE
);

CREATE TABLE articulos (
    id_articulo INT,
    id_vendedor INT,
    descripcion TEXT,
    precio NUMERIC,
    fecha_publicacion DATE
);

CREATE TABLE compras (
    id_compra INT,
    id_usuario INT,
    id_articulo INT,
    precio NUMERIC,
    fecha_compra DATE
);

CREATE TABLE favoritos (
    id_favorito INT,
    id_usuario INT,
    id_articulo INT,
    fecha DATE
);

CREATE TABLE resenas (
    id_compra INT,
    resena TEXT,
    valoracion INT
);

CREATE TABLE chats (
    id_chat INT,
    id_comprador INT,
    id_articulo INT,
    fecha DATE,
    hora TIME,
    mensaje TEXT
);

-- ============================
-- USUARIOS
-- ============================
INSERT INTO usuarios (id_usuario, nombre, email, telefono, fecha_alta) VALUES
(1, 'Ana Pérez', 'ana@example.com', '600111111', '2024-01-10'),   -- Vende (1,2), compra (9)
(2, 'Luis García', 'luis@example.com', '600222222', '2024-02-15'), -- Vende (3,4), compra (1,10)
(3, 'Marta López', 'marta@example.com', '600333333', '2024-03-20'),-- Vende (5,6), compra (2,4)
(4, 'Carlos Ruiz', 'carlos@example.com', '600444444', '2024-04-25'),-- Vende (7), compra (3,6,8)
(5, 'Lucía Fernández', 'lucia@example.com', '600555555', '2024-05-05'),-- Vende (8), compra (7)
(6, 'Pedro Sánchez', 'pedro@example.com', '600666666', '2024-06-12'), -- Vende (9,10), casi no compra
(7, 'Juan Moreno', 'juan@example.com', '600777777', '2024-06-12'); -- Usuario inactivo

-- ============================
-- ARTÍCULOS
-- ============================
INSERT INTO articulos (id_articulo, id_vendedor, descripcion, precio, fecha_publicacion) VALUES
(1, 1, 'Bicicleta de montaña', 150, '2024-06-15'),     -- De Ana
(2, 1, 'Teléfono Samsung Galaxy', 200, '2024-06-20'),  -- De Ana
(3, 2, 'Portátil Lenovo', 450, '2024-06-25'),          -- De Luis
(4, 2, 'Auriculares inalámbricos', 50, '2024-06-26'),  -- De Luis
(5, 3, 'Mesa de comedor', 120, '2024-06-27'),          -- De Marta
(6, 3, 'Silla de oficina', 75, '2024-06-28'),          -- De Marta
(7, 4, 'Cámara réflex Canon', 600, '2024-06-30'),      -- De Carlos
(8, 5, 'Patinete eléctrico', 300, '2024-07-01'),       -- De Lucía
(9, 6, 'PlayStation 4', 180, '2024-07-05'),            -- De Pedro
(10, 6, 'Colección de libros Harry Potter', 90, '2024-07-06'); -- De Pedro

-- ============================
-- COMPRAS
-- ============================
INSERT INTO compras (id_compra, id_usuario, id_articulo, precio, fecha_compra) VALUES
(1, 2, 1, 140, '2024-07-01'),  -- Luis compra bici (Ana)
(2, 3, 2, 190, '2024-07-03'),  -- Marta compra móvil (Ana)
(3, 4, 3, 430, '2024-07-05'),  -- Carlos compra portátil (Luis)
(4, 5, 7, 590, '2024-07-08'),  -- Lucía compra cámara (Carlos)
(5, 1, 9, 180, '2024-07-10'),  -- Ana compra Play (Pedro)
(6, 3, 4, 55, '2024-07-12'),   -- Marta compra auriculares (Luis)
(7, 4, 6, 70, '2024-07-13'),   -- Carlos compra silla (Marta)
(8, 4, 8, 290, '2024-07-14'),  -- Carlos compra patinete (Lucía)
(9, 2, 10, 85, '2024-07-15');  -- Luis compra libros (Pedro)

-- ============================
-- FAVORITOS
-- ============================
INSERT INTO favoritos (id_favorito, id_usuario, id_articulo, fecha) VALUES
(1, 1, 7, '2024-07-02'),     -- Ana marca cámara (Carlos)
(2, 1, 9, '2024-07-04'),     -- Ana marca Play (Pedro)
(3, 3, 1, '2024-07-01'),     -- Marta marca bici (Ana)
(4, 3, 2, '2024-07-01'),     -- Marta marca móvil (Ana)
(5, 3, 3, '2024-07-02'),     -- Marta marca portátil (Luis)
(7, 3, 7, '2024-07-03'),     -- Marta marca cámara (Carlos)
(8, 5, 7, '2024-07-03'),     -- Lucía marca cámara (Carlos)
(9, 5, 1, '2024-07-05'),     -- Lucía marca bici (Ana)
(10, 5, 3, '2024-07-09'),    -- Lucía marca portátil (Luis)
(11, 2, 7, '2024-07-02'),    -- Luis marca cámara (Carlos)
(12, 2, 2, '2024-07-02'),    -- Luis marca móvil (Ana)
(13, 2, 9, '2024-07-06'),    -- Luis marca Play (Pedro)
(14, 4, 3, '2024-07-08'),    -- Carlos marca portátil (Luis)
(15, 4, 9, '2024-07-09'),    -- Carlos marca Play (Pedro)
(16, 6, 10, '2024-07-10');   -- Pedro marca sus propios libros

-- ============================
-- RESEÑAS
-- ============================
INSERT INTO resenas (id_compra, resena, valoracion) VALUES
(1, 'Muy buena bici, en buen estado', 5),          -- Luis sobre bici (Ana)
(2, 'El móvil funciona bien, aunque la batería dura poco', 3), -- Marta sobre móvil (Ana)
(3, 'Portátil potente, satisfecho con la compra', 4), -- Carlos sobre portátil (Luis)
(4, 'La cámara llegó como nueva', 5),              -- Lucía sobre cámara (Carlos)
(5, 'La Play funciona genial, mis hijos encantados', 5), -- Ana sobre Play (Pedro)
(6, 'Una silla bastante incómoda', 1);             -- Carlos sobre silla (Marta)

-- ============================
-- CHATS
-- ============================
INSERT INTO chats (id_chat, id_comprador, id_articulo, fecha, hora, mensaje) VALUES
(1, 2, 1, '2024-06-28', '10:15', 'Hola, ¿sigue disponible la bici?'), -- Luis pregunta bici (Ana)
(2, 1, 1, '2024-06-28', '10:20', 'Sí, está disponible.'),            -- Ana responde
(3, 2, 1, '2024-06-28', '10:25', 'Perfecto, ¿puedo verla esta tarde?'), -- Luis insiste
(4, 1, 1, '2024-06-28', '10:30', 'Claro, a las 18h te viene bien?'),  -- Ana confirma

(5, 3, 2, '2024-07-01', '16:40', '¿El móvil tiene cargador incluido?'), -- Marta pregunta móvil (Ana)
(6, 1, 2, '2024-07-01', '16:45', 'Sí, lo entrego con cargador y funda.'), -- Ana responde
(7, 3, 2, '2024-07-01', '16:50', 'Perfecto, me interesa.'), -- Marta confirma

(8, 5, 7, '2024-07-05', '09:00', '¿La cámara tiene garantía?'), -- Lucía pregunta cámara (Carlos)
(9, 4, 7, '2024-07-05', '09:10', 'Sí, aún le queda un año.'),  -- Carlos responde
(10, 5, 7, '2024-07-05', '09:15', 'Genial, me interesa.'),     -- Lucía interesada

(11, 2, 7, '2024-07-05', '10:00', 'Hola, ¿podrías dejar la cámara en 550€?'), -- Luis regatea cámara (Carlos)
(12, 4, 7, '2024-07-05', '10:05', 'Lo siento, el precio es firme en 600.'),   -- Carlos rechaza

(13, 1, 9, '2024-07-09', '20:30', '¿La Play viene con mandos?'), -- Ana pregunta Play (Pedro)
(14, 6, 9, '2024-07-09', '20:35', 'Sí, con dos mandos originales.'), -- Pedro responde
(15, 1, 9, '2024-07-09', '20:40', 'Perfecto, me interesa mucho.'); -- Ana interesada
```

# Consultas

1. Nombre del usuario y descripción de los artículos que ha comprado.

1. Nombre de los usuarios junto con el artículo que han marcado como favorito.

1. Descripción de cada artículo y nombre del vendedor que lo publicó.

1. Email de los usuarios y la reseña que han escrito (a través de sus compras).

1. Nombre de los compradores y descripción de los artículos comprados.

1. Nombre de cada usuario y mensajes que ha enviado en el chat.

1. Artículos comprados junto con el precio pagado y el vendedor.

1. Nombres de los usuarios y artículos que han reseñado.

1. Nombre del comprador y fecha de cada compra realizada.

1. Nombre de los vendedores y fecha de publicación de sus artículos.


1. Nombre del comprador, descripción del artículo y nombre del vendedor.

1. Nombre del usuario, artículo comprado y reseña escrita sobre esa compra.

1. Usuarios que han marcado como favorito un artículo y nombre del vendedor de ese artículo.

1. Chats con nombre del comprador, descripción del artículo y mensaje enviado.

1. Nombre del comprador, artículo comprado, precio pagado y nombre del vendedor.

1. Usuarios que han hecho una compra y luego han dejado una reseña, mostrando comprador, artículo, reseña.

1. Compras con comprador, artículo, vendedor y fecha de compra.

1. Favoritos con usuario que lo marcó, descripción del artículo y vendedor del artículo.

1. Chats con comprador, vendedor y mensaje intercambiado.

1. Reseñas indicando comprador, artículo y valoración.


1. Número de artículos publicados por cada vendedor. (BONUS: Número de artículos publicados por cada usuario)

1. Número de artículos comprados por cada usuario.

1. Número de favoritos que tiene cada artículo.

1. Precio medio de los artículos comprados por cada usuario.

1. Precio máximo y mínimo de los artículos comprados por cada usuario.

1. Número de reseñas escritas por cada usuario.

1. Valoración media recibida por cada artículo.

1. Usuarios que han marcado más de 2 artículos como favoritos.

1. Gasto total de cada usuario en compras.

1. Número de mensajes enviados en los chats por cada usuario.


1. Vendedores que han vendido más de un artículo.

1. Usuarios que han escrito más de una reseña, ordenados por número de reseñas descendente.

1. Artículos que tienen más de 2 favoritos.

1. Gasto medio en compras por usuario, mostrando solo aquellos cuyo gasto medio supere 150€.

1. Usuarios que han comprado más de 2 artículos, ordenados alfabéticamente.

1. Artículos que han recibido una valoración media superior a 4.

1. Vendedores cuyos artículos han sido comprados por más de 2 usuarios distintos.

1. Artículo más caro comprado por cada usuario.

1. Usuarios que han enviado más de 3 mensajes en chats.

1. Artículos con más de una reseña, ordenados por valoración media descendente.


1. Los 3 artículos más caros que han sido comprados.

1. El segundo artículo más caro publicado por cada vendedor. ***

1. Los 5 usuarios que más compras han realizado.

1. Los 2 artículos con más favoritos.

1. El artículo más barato que ha vendido cada usuario.

1. Usuarios que no han comprado nunca.

1. Artículos que no han recibido ninguna reseña.

1. Los 3 usuarios que más dinero han gastado en compras.

1. Artículos cuyo precio está por encima de la media de todos los artículos.

1. Usuarios que han comprado un artículo y también lo han marcado como favorito.









