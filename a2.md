# JOINS

```sql
DROP TABLE IF EXISTS usuarios, articulos, compras, favoritos, resenas, chats;

CREATE TABLE usuarios (
    id_usuario INT,
    nombre TEXT,
    email TEXT,
    telefono TEXT,
    fecha_alta DATE
);

CREATE TABLE articulos (
    id_articulo INT,
    id_vendedor INT,
    descripcion TEXT,
    precio NUMERIC,
    fecha_publicacion DATE
);

CREATE TABLE compras (
    id_compra INT,
    id_usuario INT,
    id_articulo INT,
    precio NUMERIC,
    fecha_compra DATE
);

CREATE TABLE favoritos (
    id_favorito INT,
    id_usuario INT,
    id_articulo INT,
    fecha DATE
);

CREATE TABLE resenas (
    id_resena INT,
    id_usuario INT,
    id_articulo INT,
    resena TEXT,
    valoracion INT
);

CREATE TABLE chats (
    id_chat INT,
    id_comprador INT,
    id_articulo INT,
    fecha DATE,
    hora TIME,
    mensaje TEXT
);

-- ============================
-- USUARIOS
-- ============================
INSERT INTO usuarios (id_usuario, nombre, email, telefono, fecha_alta) VALUES
(1, 'Ana Pérez', 'ana@example.com', '600111111', '2024-01-10'),   -- Vendedora de artículos 1 y 2, compradora de artículo 9
(2, 'Luis García', 'luis@example.com', '600222222', '2024-02-15'), -- Vendedor de artículos 3 y 4, comprador de artículo 1
(3, 'Marta López', 'marta@example.com', '600333333', '2024-03-20'),-- Vendedora de artículos 5 y 6, compradora de artículo 2
(4, 'Carlos Ruiz', 'carlos@example.com', '600444444', '2024-04-25'),-- Vendedor de artículo 7, comprador de artículo 3
(5, 'Lucía Fernández', 'lucia@example.com', '600555555', '2024-05-05'),-- Vendedora de artículo 8, compradora de artículo 7
(6, 'Pedro Sánchez', 'pedro@example.com', '600666666', '2024-06-12'); -- Vendedor de artículos 9 y 10

-- ============================
-- ARTÍCULOS (id_vendedor → referencia a usuarios.id_usuario)
-- ============================
INSERT INTO articulos (id_articulo, id_vendedor, descripcion, precio, fecha_publicacion) VALUES
(1, 1, 'Bicicleta de montaña', 150, '2024-06-15'),     -- Vendido por Ana
(2, 1, 'Teléfono Samsung Galaxy', 200, '2024-06-20'),  -- Vendido por Ana
(3, 2, 'Portátil Lenovo', 450, '2024-06-25'),          -- Vendido por Luis
(4, 2, 'Auriculares inalámbricos', 50, '2024-06-26'),  -- Vendido por Luis
(5, 3, 'Mesa de comedor', 120, '2024-06-27'),          -- Vendido por Marta
(6, 3, 'Silla de oficina', 75, '2024-06-28'),          -- Vendido por Marta
(7, 4, 'Cámara réflex Canon', 600, '2024-06-30'),      -- Vendido por Carlos
(8, 5, 'Patinete eléctrico', 300, '2024-07-01'),       -- Vendido por Lucía
(9, 6, 'PlayStation 4', 180, '2024-07-05'),            -- Vendido por Pedro
(10, 6, 'Colección de libros Harry Potter', 90, '2024-07-06'); -- Vendido por Pedro

-- ============================
-- COMPRAS (id_usuario → comprador, id_articulo → comprado)
-- ============================
INSERT INTO compras (id_compra, id_usuario, id_articulo, precio, fecha_compra) VALUES
(1, 2, 1, 140, '2024-07-01'),  -- Luis compra la bici (art.1) a Ana
(2, 3, 2, 190, '2024-07-03'),  -- Marta compra el móvil (art.2) a Ana
(3, 4, 3, 430, '2024-07-05'),  -- Carlos compra el portátil (art.3) a Luis
(4, 5, 7, 590, '2024-07-08'),  -- Lucía compra la cámara (art.7) a Carlos
(5, 1, 9, 170, '2024-07-10'),  -- Ana compra la Play (art.9) a Pedro
(6, 2, 4, 45, '2024-07-12'),   -- Luis compra los auriculares (art.4) a Luis (otro vendedor)
(7, 3, 6, 70, '2024-07-13'),   -- Marta compra la silla (art.6) a Marta (otro vendedor)
(8, 5, 8, 290, '2024-07-14'),  -- Lucía compra el patinete (art.8) a Lucía (otro vendedor)
(9, 2, 10, 85, '2024-07-15');  -- Luis compra los libros (art.10) a Pedro

-- ============================
-- FAVORITOS (id_usuario marca id_articulo como favorito)
-- ============================
INSERT INTO favoritos (id_favorito, id_usuario, id_articulo, fecha) VALUES
(1, 3, 1, '2024-07-01'),    -- Marta marca favorito la bici de Ana
(2, 3, 2, '2024-07-01'),    -- Marta marca favorito el móvil de Ana
(3, 3, 3, '2024-07-02'),    -- Marta marca favorito el portátil de Luis
(4, 3, 7, '2024-07-03'),    -- Marta marca favorito el la cámara de Carlos
(5, 1, 7, '2024-07-02'),    -- Ana marca favorito la cámara de Carlos
(6, 2, 7, '2024-07-02'),    -- Luis marca favorito la cámara de Carlos
(7, 5, 7, '2024-07-03'),    -- Lucía marca favorito la cámara de Carlos
(8, 2, 3, '2024-07-02'),    -- Luis marca favorito el portátil de Luis
(9, 2, 9, '2024-07-06'),    -- Luis marca favorito la Play de Pedro
(10, 1, 2, '2024-07-04'),    -- Ana marca favorito el móvil de Ana
(11, 5, 1, '2024-07-05'),    -- Lucía marca favorito la bici de Ana
(12, 4, 7, '2024-07-08'),    -- Carlos marca favorito la cámara de Carlos
(13, 5, 8, '2024-07-09'),    -- Lucía marca favorito el patinete de Lucía
(14, 4, 9, '2024-07-09'),    -- Carlos marca favorito la Play de Pedro
(15, 6, 10, '2024-07-10');   -- Pedro marca favorito sus propios libros (auto-favorito)

-- ============================
-- RESEÑAS (id_usuario escribe reseña sobre id_articulo)
-- ============================
INSERT INTO resenas (id_resena, id_usuario, id_articulo, resena, valoracion) VALUES
(1, 2, 1, 'Muy buena bici, en buen estado', 5),                      -- Luis reseña la bici de Ana (que compró él)
(2, 3, 2, 'El móvil funciona bien, aunque la batería dura poco', 3), -- Marta reseña el móvil de Ana (que compró ella)
(3, 4, 3, 'Portátil potente, satisfecho con la compra', 4),          -- Carlos reseña el portátil de Luis (que compró él)
(4, 5, 7, 'La cámara llegó como nueva', 5),                          -- Lucía reseña la cámara de Carlos (que compró ella)
(5, 1, 9, 'La Play funciona genial, mis hijos encantados', 5);       -- Ana reseña la Play de Pedro (que compró ella)

-- ============================
-- CHATS (id_comprador habla sobre id_articulo con el vendedor implícito en articulos.id_vendedor)
-- ============================
INSERT INTO chats (id_chat, id_comprador, id_articulo, fecha, hora, mensaje) VALUES
(1, 2, 1, '2024-06-28', '10:15', 'Hola, ¿sigue disponible la bici?'),    -- Luis (comprador) a Ana (vendedora)
(2, 1, 1, '2024-06-28', '10:20', 'Sí, está disponible.'),                -- Ana (vendedora) responde a Luis
(3, 2, 1, '2024-06-28', '10:25', 'Perfecto, ¿puedo verla esta tarde?'),  -- Luis sigue el chat sobre la bici
(4, 3, 2, '2024-07-01', '16:40', '¿El móvil tiene cargador incluido?'),  -- Marta (compradora) a Ana (vendedora)
(5, 1, 2, '2024-07-01', '16:45', 'Sí, lo entrego con cargador y funda.'),-- Ana responde a Marta
(6, 4, 3, '2024-07-03', '12:10', '¿Aceptas 400 por el portátil?'),       -- Carlos (comprador) a Luis (vendedor)
(7, 2, 3, '2024-07-03', '12:20', 'Lo siento, mínimo 430.'),              -- Luis responde a Carlos
(8, 5, 7, '2024-07-06', '09:00', '¿La cámara tiene garantía?'),          -- Lucía (compradora) a Carlos (vendedor)
(9, 4, 7, '2024-07-06', '09:10', 'Sí, aún le queda un año.'),            -- Carlos responde a Lucía
(10, 1, 9, '2024-07-09', '20:30', '¿La Play viene con mandos?');         -- Ana (compradora) a Pedro (vendedor)

```

# Consultas

1. Todos los artículos junto con el nombre de su vendedor.

1. Las compras indicando el nombre del comprador y el precio pagado.


1. Todos los chats junto con el nombre del comprador que los inició.

1. Mos artículos junto con las reseñas recibidas (solo el texto de la reseña).

1. El nombre de cada usuario y las reseñas que escribió.

1. Los mensajes de chat junto con la descripción del artículo al que pertenecen.

1. Cada artículo con su precio y la valoración que recibió en una reseña.

1. El nombre de cada usuario y los artículos que tiene en favoritos.

1. Los usuarios junto con los artículos que han comprado.

1. Los usuarios y la fecha en que publicaron artículos en la plataforma.

1. Las compras indicando el comprador, el artículo y el vendedor.

1. Todos los artículos que un usuario ha marcado como favoritos mostrando también al vendedor.

1. Las reseñas indicando el nombre del usuario que la escribió, el artículo reseñado y el vendedor de ese artículo.

1. Los mensajes de los chats mostrando comprador, vendedor y artículo.

1. Las compras realizadas por cada usuario con el precio pagado y la fecha, junto al nombre del vendedor.

1. Los artículos junto con la cantidad de veces que han sido añadidos a favoritos.

1. Los usuarios y el número de artículos que han publicado a la venta.

1. Los artículos con el promedio de valoraciones recibidas.

1. Cada usuario y la cantidad total de compras que ha realizado.

1. Los chats y el número de mensajes que contiene cada uno.

1. El top 3 de artículos más vendidos (con su número de ventas).

1. Los usuarios que nunca han comprado ningún artículo.

1. Los usuarios que han comprado artículos de al menos 3 vendedores distintos.

1. Los artículos que tienen más de 2 reseñas y una valoración media superior a 4.


1. El usuario que más mensajes ha enviado en los chats de la plataforma.





