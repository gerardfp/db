# JOINS

```sql
DROP TABLE IF EXISTS usuarios, articulos, compras, favoritos, resenas, chats;

CREATE TABLE usuarios (
    id_usuario INT,
    nombre TEXT,
    email TEXT,
    telefono TEXT,
    fecha_alta DATE
);

CREATE TABLE articulos (
    id_articulo INT,
    id_vendedor INT,
    descripcion TEXT,
    precio NUMERIC,
    fecha_publicacion DATE
);

CREATE TABLE compras (
    id_compra INT,
    id_usuario INT,
    id_articulo INT,
    precio NUMERIC,
    fecha_compra DATE
);

CREATE TABLE favoritos (
    id_favorito INT,
    id_usuario INT,
    id_articulo INT,
    fecha DATE
);

CREATE TABLE resenas (
    id_resena INT,
    id_usuario INT,
    id_articulo INT,
    resena TEXT,
    valoracion INT
);

CREATE TABLE chats (
    id_chat INT,
    id_comprador INT,
    id_articulo INT,
    fecha DATE,
    hora TIME,
    mensaje TEXT
);

-- ============================
-- USUARIOS
-- ============================
INSERT INTO usuarios (id_usuario, nombre, email, telefono, fecha_alta) VALUES
(1, 'Ana Pérez', 'ana@example.com', '600111111', '2024-01-10'),   -- Vendedora de artículos 1 y 2, compradora de artículo 9
(2, 'Luis García', 'luis@example.com', '600222222', '2024-02-15'), -- Vendedor de artículos 3 y 4, comprador de artículos 1 y 10
(3, 'Marta López', 'marta@example.com', '600333333', '2024-03-20'),-- Vendedora de artículos 5 y 6, compradora de artículos 2 y 4
(4, 'Carlos Ruiz', 'carlos@example.com', '600444444', '2024-04-25'),-- Vendedor de artículo 7, comprador de artículos 3, 6 y 8
(5, 'Lucía Fernández', 'lucia@example.com', '600555555', '2024-05-05'),-- Vendedora de artículo 8, compradora de artículo 7
(6, 'Pedro Sánchez', 'pedro@example.com', '600666666', '2024-06-12'); -- Vendedor de artículos 9 y 10

-- ============================
-- ARTÍCULOS (id_vendedor → referencia a usuarios.id_usuario)
-- ============================
INSERT INTO articulos (id_articulo, id_vendedor, descripcion, precio, fecha_publicacion) VALUES
(1, 1, 'Bicicleta de montaña', 150, '2024-06-15'),     -- Vendido por Ana
(2, 1, 'Teléfono Samsung Galaxy', 200, '2024-06-20'),  -- Vendido por Ana
(3, 2, 'Portátil Lenovo', 450, '2024-06-25'),          -- Vendido por Luis
(4, 2, 'Auriculares inalámbricos', 50, '2024-06-26'),  -- Vendido por Luis
(5, 3, 'Mesa de comedor', 120, '2024-06-27'),          -- Vendido por Marta
(6, 3, 'Silla de oficina', 75, '2024-06-28'),          -- Vendido por Marta
(7, 4, 'Cámara réflex Canon', 600, '2024-06-30'),      -- Vendido por Carlos
(8, 5, 'Patinete eléctrico', 300, '2024-07-01'),       -- Vendido por Lucía
(9, 6, 'PlayStation 4', 180, '2024-07-05'),            -- Vendido por Pedro
(10, 6, 'Colección de libros Harry Potter', 90, '2024-07-06'); -- Vendido por Pedro

-- ============================
-- COMPRAS (id_usuario → comprador, id_articulo → comprado)
-- ============================
INSERT INTO compras (id_compra, id_usuario, id_articulo, precio, fecha_compra) VALUES
(1, 2, 1, 140, '2024-07-01'),  -- Luis compra la bici (art.1) a Ana
(2, 3, 2, 190, '2024-07-03'),  -- Marta compra el móvil (art.2) a Ana
(3, 4, 3, 430, '2024-07-05'),  -- Carlos compra el portátil (art.3) a Luis
(4, 5, 7, 590, '2024-07-08'),  -- Lucía compra la cámara (art.7) a Carlos
(5, 1, 9, 180, '2024-07-10'),  -- Ana compra la Play (art.9) a Pedro
(6, 3, 4, 55, '2024-07-12'),   -- Marta compra los auriculares (art.4) a Luis
(7, 4, 6, 70, '2024-07-13'),   -- Carlos compra la silla (art.6) a Marta
(8, 4, 8, 290, '2024-07-14'),  -- Carlos compra el patinete (art.8) a Lucía
(9, 2, 10, 85, '2024-07-15');  -- Luis compra los libros (art.10) a Pedro

-- ============================
-- FAVORITOS (id_usuario marca id_articulo como favorito)
-- ============================
INSERT INTO favoritos (id_favorito, id_usuario, id_articulo, fecha) VALUES
(1, 1, 7, '2024-07-02'),     -- Ana marca favorito la cámara de Carlos
(2, 1, 9, '2024-07-04'),     -- Ana marca favorito la Play de Pedro
(3, 3, 1, '2024-07-01'),     -- Marta marca favorito la bici de Ana
(4, 3, 2, '2024-07-01'),     -- Marta marca favorito el móvil de Ana
(5, 3, 3, '2024-07-02'),     -- Marta marca favorito el portátil de Luis
(7, 3, 7, '2024-07-03'),     -- Marta marca favorito el la cámara de Carlos
(8, 5, 7, '2024-07-03'),     -- Lucía marca favorito la cámara de Carlos
(9, 5, 1, '2024-07-05'),     -- Lucía marca favorito la bici de Ana
(10, 5, 3, '2024-07-09'),    -- Lucía marca favorito el portátil de Luis
(11, 2, 7, '2024-07-02'),    -- Luis marca favorito la cámara de Carlos
(12, 2, 2, '2024-07-02'),    -- Luis marca favorito el móvil de Ana
(13, 2, 9, '2024-07-06'),    -- Luis marca favorito la Play de Pedro
(14, 4, 3, '2024-07-08'),    -- Carlos marca favorito el portátil de Luis
(15, 4, 9, '2024-07-09'),    -- Carlos marca favorito la Play de Pedro
(16, 6, 10, '2024-07-10');   -- Pedro marca favorito sus propios libros (auto-favorito)

-- ============================
-- RESEÑAS (id_usuario escribe reseña sobre id_articulo)
-- ============================
INSERT INTO resenas (id_resena, id_compra, resena, valoracion) VALUES
(1, 1, 'Muy buena bici, en buen estado', 5),                      -- Luis reseña la bici de Ana
(2, 2, 'El móvil funciona bien, aunque la batería dura poco', 3), -- Marta reseña el móvil de Ana
(3, 3, 'Portátil potente, satisfecho con la compra', 4),          -- Carlos reseña el portátil de Luis
(4, 4, 'La cámara llegó como nueva', 5),                          -- Lucía reseña la cámara de Carlos
(5, 5, 'La Play funciona genial, mis hijos encantados', 5);       -- Ana reseña la Play de Pedro
(6, 7, 'Una silla bastante incómoda', 1);                         -- Carlos reseña la silla de Marta

-- ============================
-- CHATS (id_comprador habla sobre id_articulo con el vendedor implícito en articulos.id_vendedor)
-- ============================
INSERT INTO chats (id_chat, id_comprador, id_articulo, fecha, hora, mensaje) VALUES
-- Conversación 1: Luis (id 2) con Ana (id 1) sobre la **bici** (art.1)
(1, 2, 1, '2024-06-28', '10:15', 'Hola, ¿sigue disponible la bici?'),
(2, 1, 1, '2024-06-28', '10:20', 'Sí, está disponible.'),
(3, 2, 1, '2024-06-28', '10:25', 'Perfecto, ¿puedo verla esta tarde?'),
(4, 1, 1, '2024-06-28', '10:30', 'Claro, a las 18h te viene bien?'),
-- Conversación 2: Marta (id 3) con Ana (id 1) sobre el **móvil** (art.2)
(5, 3, 2, '2024-07-01', '16:40', '¿El móvil tiene cargador incluido?'),
(6, 1, 2, '2024-07-01', '16:45', 'Sí, lo entrego con cargador y funda.'),
(7, 3, 2, '2024-07-01', '16:50', 'Perfecto, me interesa.'),
-- Conversación 3: Carlos (id 4) y Lucía (id 5) preguntan sobre la **cámara** (art.7 de Carlos)
(8, 5, 7, '2024-07-05', '09:00', '¿La cámara tiene garantía?'), 
(9, 4, 7, '2024-07-05', '09:10', 'Sí, aún le queda un año.'),
(10, 5, 7, '2024-07-05', '09:15', 'Genial, me interesa.'),
-- Otro usuario (Luis) también pregunta por la misma **cámara**
(11, 2, 7, '2024-07-05', '10:00', 'Hola, ¿podrías dejar la cámara en 550€?'),
(12, 4, 7, '2024-07-05', '10:05', 'Lo siento, el precio es firme en 600.'),
-- Conversación 4: Ana (id 1) con Pedro (id 6) sobre la **Play** (art.9)
(13, 1, 9, '2024-07-09', '20:30', '¿La Play viene con mandos?'),
(14, 6, 9, '2024-07-09', '20:35', 'Sí, con dos mandos originales.'),
(15, 1, 9, '2024-07-09', '20:40', 'Perfecto, me interesa mucho.');
```

# Consultas

1. Los artículos junto con el nombre de su vendedor.

1. Las compras indicando el nombre del comprador y el precio pagado.

1. Los chats junto con el nombre del comprador que los inició.

1. La descripción de los articulos, el precio de venta, y el precio de compra.

1. Los mensajes de las reseñas y la fecha de compra.

1. Los artículos y el número de favoritos de cada uno.

1. El nombre de cada usuario y las reseñas que escribió.

1. Los mensajes de chat junto con la descripción del artículo al que pertenecen.

1. Cada artículo con su precio y la valoración que recibió en una reseña.

1. El nombre de cada usuario y los artículos que tiene en favoritos.

1. Los usuarios junto con los artículos que han comprado.

1. Los artículos junto con las reseñas recibidas (solo el texto de la reseña).

1. Los usuarios y la fecha en que publicaron artículos en la plataforma.

1. Las compras indicando el comprador, el artículo y el vendedor.

1. Los artículos que un usuario ha marcado como favoritos mostrando también al vendedor.

1. Las reseñas indicando el nombre del usuario que la escribió, el artículo reseñado y el vendedor de ese artículo.

1. Los mensajes de los chats mostrando comprador, vendedor y artículo.

1. Las compras realizadas por cada usuario con el precio pagado y la fecha, junto al nombre del vendedor.

1. Los artículos junto con la cantidad de veces que han sido añadidos a favoritos.

1. Los usuarios y el número de artículos que han publicado a la venta.

1. Los artículos con el promedio de valoraciones recibidas.

1. Cada usuario y la cantidad total de compras que ha realizado.

1. Los chats y el número de mensajes que contiene cada uno.

1. El top 3 de artículos más vendidos (con su número de ventas).

1. Los usuarios que nunca han comprado ningún artículo.

1. Los usuarios que han comprado artículos de al menos 3 vendedores distintos.

1. Los artículos que tienen más de 2 reseñas y una valoración media superior a 4.

1. El usuario que más mensajes ha enviado en los chats de la plataforma.









